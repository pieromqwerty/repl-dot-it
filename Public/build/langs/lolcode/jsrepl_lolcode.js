(function(){self.JSREPLEngine=function(){function b(a,c,j,e,f,b){var i;this.error=e;this.sandbox=f;f=function(k){return function(){return a(function(a){return k.machine.resume(a)})}}(this);i=function(a){return function(g){c(g);return a.machine.resume()}}(this);e=function(a){return function(g){error(g);a.machine.reset();a.machine.halted=true;return a.machine.instruction_ptr=a.machine.instructions.length}}(this);this.result_handler=function(a){return function(){var g;g=a.machine.frames[0].variables.IT;
return g===a.last_it?j(""):(a.last_it=g,j(g.value===null?"":String(g.value)))}}(this);this.context=new this.sandbox.LOLCoffee.CodeGenContext;this.machine=new this.sandbox.LOLCoffee.Machine(this.context,f,i,e,this.result_handler,true);this.last_it=null;b()}b.prototype.Compile=function(a){return(new this.sandbox.LOLCoffee.Parser((new this.sandbox.LOLCoffee.Tokenizer(a)).tokenize())).parseProgram().codegen(this.context)};b.prototype.Eval=function(a){try{this.Compile(a)}catch(c){this.error(c);return}return this.machine.run()};
b.prototype.EvalSync=function(a){this.Compile(a);this.machine.done=function(){};this.machine.run();this.machine.done=this.result_handler;a=this.machine.frames[0].variables.IT;return a===this.last_it?null:(this.last_it=a,a.value)};b.prototype.GetNextLineIndent=function(a){var c,b,e,f,h;if(/\.\.\.\s*$/.test(a))return 0;try{c=(new this.sandbox.LOLCoffee.Tokenizer(a)).tokenize()}catch(i){return false}try{return(new this.sandbox.LOLCoffee.Parser(c.slice(0))).parseProgram(),false}catch(k){a=[];b=[];for(e=
0,f=c.length;e<f;e++)h=c[e],h.type==="endline"?(a.push(b),b=[]):b.push(h);c=function(a,b){var c,e,f,d;b==null&&(b=false);d=[];for(c=0,e=a.length;c<e;c++)switch(f=a[c],f[0].text){case "HAI":d.push("KTHXBYE");break;case "HOW DUZ I":d.push("IF U SAY SO");break;case "IM IN YR":d.push("IM OUTTA YR");break;case "O RLY?":case "WTF?":d.push("OIC");break;case "YA RLY":case "NO WAI":case "MEBBE":if(b&&d.length===0)d.push("OIC");else if(d[d.length-1]!=="OIC")return-1;break;case "KTHXBYE":case "IF U SAY SO":case "IM OUTTA YR":case "OIC":if(d[d.length-
1]===f[0].text)d.pop();else return-1}return d.length};return c(a)<=0?false:c([a.slice(-1)[0]],true)>0?1:0}};return b}()}).call(this);
