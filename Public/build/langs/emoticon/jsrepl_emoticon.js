(function(){self.JSREPLEngine=function(){function c(a,b,f,d,c,g){this.input=a;this.output=b;this.error=d;this.sandbox=c;this.result_fn_factory=function(a){return function(b){var e,f,d,c;c="";for(f in b)e=b[f],d=e.toString(),e=d.length-74,e=e>0?e:0,d=d.slice(e),e>0&&(d="..."+d),c+="\n"+f+": "+d;return a(c)}};this.result_handler=this.result_fn_factory(f);this.interpreter=new this.sandbox.Emoticon.Interpreter({source:[],input:this.input,print:this.output,result:this.result_handler});g()}c.prototype.Eval=
function(a){var b;try{if(a.match(/^RESET\b/))this.interpreter=new this.sandbox.Emoticon.Interpreter({source:[],input:this.input,print:this.output,result:this.result_handler}),a=a.replace(/^RESET/,"");b=new this.sandbox.Emoticon.Parser(a);this.interpreter.lists.Z=this.interpreter.lists.Z.concat(b);return this.interpreter.run()}catch(f){return this.error(f)}};c.prototype.EvalSync=function(a){var b;this.interpreter.lists.Z=this.interpreter.lists.Z.concat(new this.sandbox.Emoticon.Parser(a));b=null;this.interpreter.result=
this.result_fn_factory(function(a){return b=a});this.interpreter.run();this.interpreter.result=this.result_handler;return b};c.prototype.GetNextLineIndent=function(a){var b;b=function(a){return function(b){var c,g,h,i;i=new a.sandbox.Emoticon.Parser(b);g=0;for(b=0,c=i.length;b<c;b++)if(h=i[b],h.mouth)switch(h.mouth){case "(":++g;break;case ")":--g}return g}}(this);return b(a)<=0?false:(a=b(a.split("\n").slice(-1)[0]),a>0?1:a<0?a:0)};return c}()}).call(this);
